![image](https://github.com/user-attachments/assets/9fb4dfbf-44ed-443c-a10a-8b4966dac83f)# Проект кластеризации на Python

## Оглавление
1. [Введение](#введение)
2. [Использование](#использование)
3. [Модули](#модули)
4. [Интерпретация кластеров](#интерпретация-кластеров)
5. [Дополнительно](#дополнительно)

## Введение

Данный проект представляет собой интерактивное веб-приложение на Python, предназначенное для анализа кластеризации с использованием алгоритмов **k-means** и **иерархической кластеризации**. Пользователь может выбрать один из предустановленных наборов данных или загрузить свой собственный `.csv` файл для анализа.

Приложение построено с использованием библиотеки **Gradio**, что позволяет легко визуализировать:
- Кластеры (k-means и агломеративные)
- Дендрограммы
- Elbow-графики
- Силуэт-графики
- Распределения после PCA

## Использование

Для запуска проекта выполните следующие шаги:

```bash
# Клонируйте репозиторий
git clone https://github.com/NicolasRAA/clustering-webapp.git
cd clustering-webapp

# Создайте виртуальное окружение
python -m venv venv
source venv/bin/activate   # Windows: venv\Scripts\activate

# Установите зависимости
pip install -r requirements.txt

# Если соединение с pypi.org нестабильно, используйте зеркало:
pip install -r requirements.txt -i https://pypi.tuna.tsinghua.edu.cn/simple

# (Опционально) Сгенерируйте встроенные наборы данных
python generate_datasets.py

# Запустите приложение
python app.py
```

После запуска приложение откроется в браузере по адресу `http://127.0.0.1:7860`.

<details>
  <summary>Пример вывода в терминале</summary>

```bash
(venv) $ python app.py
Running on local URL:  http://127.0.0.1:7860/
```
</details>

<details>
  <summary>Рекомендованные параметры для наборов данных</summary>

| Набор данных       | Рекомендуемое количество кластеров (k) | Метод связи (иерархическая кластеризация) | Использовать PCA?         | Комментарий                                           |
|--------------------|-----------------------------------------|--------------------------------------------|---------------------------|--------------------------------------------------------|
| Wine               | 3                                       | `ward`                                     | Да                        | Соответствует 3 классам вина (`target`: 0, 1, 2)       |
| Wholesale          | 4–6                                     | `average`                                  | Да                        | Покупатели с разным профилем потребления               |
| Mall Customers     | 4–5                                     | `complete`                                 | Нет (уже 2 признака)      | Сегментация по доходу и индексу расходов               |

> **ВАЖНО:** В таблице выше для набора данных `Wholesale` рекомендован метод связи `average`, так как он традиционно используется при наличии данных с высокой дисперсией и выбросами. Однако в ходе эмпирического анализа было выявлено, что метод `ward` показывает более четкую и интерпретируемую кластеризацию для этого конкретного набора.

<details>
  <summary>Почему ward оказался предпочтительнее в данном случае?</summary>

При сравнении результатов кластеризации с использованием разных методов связи (linkage) была выявлена следующая картина:

  | Метод         | Визуализация кластеров                         | Дендрограмма                           |
  |---------------|-----------------------------------------------|----------------------------------------|
  | `average`     | ![image](https://github.com/user-attachments/assets/b85641c0-1953-4a08-899f-16fadeb7e0e0) | ![image](https://github.com/user-attachments/assets/78d24000-a02b-4679-9d58-5ac701c34784) |
  | `ward`        | ![image](https://github.com/user-attachments/assets/59c17900-b1d5-460d-94a5-155a5941c928) | ![image](https://github.com/user-attachments/assets/13e4a513-07ff-47a9-ac06-65f858c06009) |

  - На графике с `average` наблюдается сильная асимметрия: почти все точки попадают в один кластер, а остальные разбросаны по одиночке — это затрудняет интерпретацию.
  - В то время как `ward` формирует более сбалансированные группы с отчетливым разделением и дендрограмма показывает хорошо выраженные уровни иерархии.

  **Вывод:** несмотря на теоретические ожидания, метод `ward` обеспечивает более качественную кластеризацию для набора `Wholesale` и может использоваться по умолчанию в интерфейсе.
</details>

> Если вы загружаете собственный `.csv` файл, выберите значение `k`, исходя из структуры и количества признаков. Используйте Elbow-график и силуэт-анализ для обоснования выбора.

</details>


## Модули

| Имя файла              | Назначение                                       |
|------------------------|--------------------------------------------------|
| `app.py`               | Главный интерфейс Gradio                         |
| `preprocessing.py`     | Загрузка, очистка, масштабирование, PCA          |
| `clustering.py`        | Алгоритмы кластеризации (k-means, иерархическая) |
| `evaluation.py`        | Расчёт метрик (силуэт, инерция)                  |
| `visualization.py`     | Построение графиков и визуализаций               |
| `generate_datasets.py` | Генерация `.csv` файлов из открытых источников   |


## Интерпретация кластеров

Ниже приведены возможные интерпретации кластеров для каждого набора данных:

| Набор данных     | Возможные значения кластеров (гипотетически)                                   |
|------------------|----------------------------------------------------------------------------------|
| Wine             | `target` = 0, 1, 2 → три сорта вина (например: Каберне, Мерло, Пино Нуар)        |
| Wholesale        | Кластеры могут отражать различные типы клиентов: рестораны, ритейл, отели и т.д. |
| Mall Customers   | `k=4` или `5` → возможные сегменты по доходу и тратам (низкий/высокий/средний)   |

> Примечание: эти значения не заданы заранее. Алгоритмы кластеризации определяют группы автоматически на основе структуры данных.

## Дополнительно

- Используемые библиотеки: `scikit-learn`, `pandas`, `matplotlib`, `seaborn`, `gradio`
- Поддерживается загрузка пользовательского `.csv` файла
- Поддержка визуализации PCA и центроидов k-means
- Все функции написаны модульно и легко расширяются)
