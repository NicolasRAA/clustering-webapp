# Проект кластеризации на Python

## Оглавление
1. [Введение](#введение)
2. [Использование](#использование)
3. [Модули](#модули)
4. [Интерпретация кластеров](#интерпретация-кластеров)
5. [Дополнительно](#дополнительно)

## Введение

Данный проект представляет собой интерактивное веб-приложение на Python, предназначенное для анализа кластеризации с использованием алгоритмов **k-means** и **иерархической кластеризации**. Пользователь может выбрать один из предустановленных наборов данных или загрузить свой собственный `.csv` файл для анализа.

Приложение построено с использованием библиотеки **Gradio**, что позволяет легко визуализировать:
- Кластеры (k-means и агломеративные)
- Дендрограммы
- Elbow-графики
- Силуэт-графики
- Распределения после PCA

## Использование

Для запуска проекта выполните следующие шаги:

```bash
# Клонируйте репозиторий
git clone https://github.com/NicolasRAA/clustering-webapp.git
cd clustering-webapp

# Создайте виртуальное окружение
python -m venv venv
source venv/bin/activate   # Windows: venv\Scripts\activate

# Установите зависимости
pip install -r requirements.txt

# Если соединение с pypi.org нестабильно, используйте зеркало:
pip install -r requirements.txt -i https://pypi.tuna.tsinghua.edu.cn/simple

# (Опционально) Сгенерируйте встроенные наборы данных
python generate_datasets.py

# Запустите приложение
python app.py
```

После запуска приложение откроется в браузере по адресу `http://127.0.0.1:7860`.

<details>
  <summary>Пример вывода в терминале</summary>

```bash
(venv) $ python app.py
Running on local URL:  http://127.0.0.1:7860/
```
</details>

<details>
  <summary>Рекомендованные параметры для наборов данных</summary>

| Набор данных       | Рекомендуемое количество кластеров (k) | Метод связи (иерархическая кластеризация) | Использовать PCA?         | Комментарий                                           |
|--------------------|-----------------------------------------|--------------------------------------------|---------------------------|--------------------------------------------------------|
| Wine               | 3                                       | `ward`                                     | Да                        | Соответствует 3 классам вина (`target`: 0, 1, 2)       |
| Wholesale          | 4–6                                     | `average`                                  | Да                        | Покупатели с разным профилем потребления               |
| Mall Customers     | 4–5                                     | `complete`                                 | Нет (уже 2 признака)      | Сегментация по доходу и индексу расходов               |

> Если вы загружаете собственный `.csv` файл, выберите значение `k`, исходя из структуры и количества признаков. Используйте Elbow-график и силуэт-анализ для обоснования выбора.
</details>


## Модули

| Имя файла              | Назначение                                       |
|------------------------|--------------------------------------------------|
| `app.py`               | Главный интерфейс Gradio                         |
| `preprocessing.py`     | Загрузка, очистка, масштабирование, PCA          |
| `clustering.py`        | Алгоритмы кластеризации (k-means, иерархическая) |
| `evaluation.py`        | Расчёт метрик (силуэт, инерция)                  |
| `visualization.py`     | Построение графиков и визуализаций               |
| `generate_datasets.py` | Генерация `.csv` файлов из открытых источников   |


## Интерпретация кластеров

Ниже приведены возможные интерпретации кластеров для каждого набора данных:

| Набор данных     | Возможные значения кластеров (гипотетически)                                   |
|------------------|----------------------------------------------------------------------------------|
| Wine             | `target` = 0, 1, 2 → три сорта вина (например: Каберне, Мерло, Пино Нуар)        |
| Wholesale        | Кластеры могут отражать различные типы клиентов: рестораны, ритейл, отели и т.д. |
| Mall Customers   | `k=4` или `5` → возможные сегменты по доходу и тратам (низкий/высокий/средний)   |

> Примечание: эти значения не заданы заранее. Алгоритмы кластеризации определяют группы автоматически на основе структуры данных.

## Дополнительно

- Используемые библиотеки: `scikit-learn`, `pandas`, `matplotlib`, `seaborn`, `gradio`
- Поддерживается загрузка пользовательского `.csv` файла
- Поддержка визуализации PCA и центроидов k-means
- Все функции написаны модульно и легко расширяются)
